<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>SSPA Chess</title>
    <style>
        .game {
            width: 710px;
            height: 790px;
            overflow:hidden;
        }
        .game * {
            height: 80px;
            font-size: 50px;
            text-align: center;
            display: table-cell;
            vertical-align: middle;
        }
        .chessboard {
            width: 640px;
            height: 640px;
            border: 25px solid #333;
            margin: 20px;
        }
        .chessboard div {
            float: left;
            width: 80px;
        }
        .black {
            background-color: #999;
        }

        .white {
            background-color: #fff;
        }
        .status {
            float: left;
            width: 640px;
            background-color: #fff;
        }
    </style>
</head>
<body>
    <div class="game">
        <div class="chessboard">
            <!-- 1st -->
            <div id="a8" class="white"></div>
            <div id="b8" class="black"></div>
            <div id="c8" class="white"></div>
            <div id="d8" class="black"></div>
            <div id="e8" class="white"></div>
            <div id="f8" class="black"></div>
            <div id="g8" class="white"></div>
            <div id="h8" class="black"></div>
            <!-- 2nd -->
            <div id="a7" class="black"></div>
            <div id="b7" class="white"></div>
            <div id="c7" class="black"></div>
            <div id="d7" class="white"></div>
            <div id="e7" class="black"></div>
            <div id="f7" class="white"></div>
            <div id="g7" class="black"></div>
            <div id="h7" class="white"></div>
            <!-- 3th -->
            <div id="a6" class="white"></div>
            <div id="b6" class="black"></div>
            <div id="c6" class="white"></div>
            <div id="d6" class="black"></div>
            <div id="e6" class="white"></div>
            <div id="f6" class="black"></div>
            <div id="g6" class="white"></div>
            <div id="h6" class="black"></div>
            <!-- 4st -->
            <div id="a5" class="black"></div>
            <div id="b5" class="white"></div>
            <div id="c5" class="black"></div>
            <div id="d5" class="white"></div>
            <div id="e5" class="black"></div>
            <div id="f5" class="white"></div>
            <div id="g5" class="black"></div>
            <div id="h5" class="white"></div>
            <!-- 5th -->
            <div id="a4" class="white"></div>
            <div id="b4" class="black"></div>
            <div id="c4" class="white"></div>
            <div id="d4" class="black"></div>
            <div id="e4" class="white"></div>
            <div id="f4" class="black"></div>
            <div id="g4" class="white"></div>
            <div id="h4" class="black"></div>
            <!-- 6th -->
            <div id="a3" class="black"></div>
            <div id="b3" class="white"></div>
            <div id="c3" class="black"></div>
            <div id="d3" class="white"></div>
            <div id="e3" class="black"></div>
            <div id="f3" class="white"></div>
            <div id="g3" class="black"></div>
            <div id="h3" class="white"></div>
            <!-- 7th -->
            <div id="a2" class="white"></div>
            <div id="b2" class="black"></div>
            <div id="c2" class="white"></div>
            <div id="d2" class="black"></div>
            <div id="e2" class="white"></div>
            <div id="f2" class="black"></div>
            <div id="g2" class="white"></div>
            <div id="h2" class="black"></div>
            <!-- 8th -->
            <div id="a1" class="black"></div>
            <div id="b1" class="white"></div>
            <div id="c1" class="black"></div>
            <div id="d1" class="white"></div>
            <div id="e1" class="black"></div>
            <div id="f1" class="white"></div>
            <div id="g1" class="black"></div>
            <div id="h1"class="white"></div>
        </div>
        <div id="status" class="status"></div>
    </div>
        <script>
            var pieceMap = {
                "White,King": "♔",
                "Black,King": "♚",
                "White,Queen": "♕",
                "Black,Queen": "♛",
                "White,Rook": "♖",
                "Black,Rook": "♜",
                "White,Bishop": "♗",
                "Black,Bishop": "♝",
                "White,Knight": "♘",
                "Black,Knight": "♞",
                "White,Pawn": "♙",
                "Black,Pawn": "♟"
            };
            var initialBoard = [
                { "a7": "Black,Pawn" },
                { "b7": "Black,Pawn" },
                { "c7": "Black,Pawn" },
                { "d7": "Black,Pawn" },
                { "e7": "Black,Pawn" },
                { "f7": "Black,Pawn" },
                { "g7": "Black,Pawn" },
                { "h7": "Black,Pawn" },

                { "a8": "Black,Rook" },
                { "b8": "Black,Knight" },
                { "c8": "Black,Bishop" },
                { "d8": "Black,Queen" },
                { "e8": "Black,King" },
                { "f8": "Black,Bishop" },
                { "g8": "Black,Knight" },
                { "h8": "Black,Rook" },


                { "a2": "White,Pawn" },
                { "b2": "White,Pawn" },
                { "c2": "White,Pawn" },
                { "d2": "White,Pawn" },
                { "e2": "White,Pawn" },
                { "f2": "White,Pawn" },
                { "g2": "White,Pawn" },
                { "h2": "White,Pawn" },

                { "a1": "White,Rook" },
                { "b1": "White,Knight" },
                { "c1": "White,Bishop" },
                { "d1": "White,Queen" },
                { "e1": "White,King" },
                { "f1": "White,Bishop" },
                { "g1": "White,Knight" },
                { "h1": "White,Rook" }
            ];
            function lookupPieceHtml(lookupValue) {
                var filterResult = [lookupValue].map(e => pieceMap[e]).filter(e => e);
                return filterResult[0] ?? "?";
            }
            function setCell(location, piece) {
                document.getElementById(location).innerText = piece;
            }
            initialBoard.forEach(function (piece) {
                var location = Object.keys(piece)[0];
                var pieceName = piece[location];
                setCell(location, lookupPieceHtml(pieceName));
            });

        // HERE'S WHERE TO ADD URL PERSISTENCE
            const myParam = window.location.search[1] ?? "0"; // current move
            const whoMovesNext = myParam < 10 ? "White" : "Black";
            document.getElementById("status").innerText = whoMovesNext + " to move";
        </script>
    </body>
</html>